name: ì´ìŠˆ ìžë™í™”

on:
  issues:
    types: [opened, edited, labeled, assigned, reopened, closed]
  issue_comment:
    types: [created]

jobs:
  issue-welcome:
    name: ì´ìŠˆ í™˜ì˜ ëŒ“ê¸€
    runs-on: ubuntu-latest
    if: github.event.action == 'opened'
    
    steps:
    - name: ì´ìŠˆ ì˜¤í”ˆ í™˜ì˜ ëŒ“ê¸€
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo, number } = context.issue;
          const issueType = context.payload.issue.title;
          
          let welcomeMessage = `
          ðŸŽ‰ **ìƒˆë¡œìš´ ì´ìŠˆë¥¼ ìƒì„±í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!**
          
          ## ðŸ“‹ ì´ìŠˆ ì²˜ë¦¬ ì•ˆë‚´
          `;
          
          // ì´ìŠˆ íƒ€ìž…ì— ë”°ë¥¸ ë§žì¶¤í˜• ë©”ì‹œì§€
          if (issueType.includes('[BUG]')) {
            welcomeMessage += `
            ðŸ› **ë²„ê·¸ ë¦¬í¬íŠ¸**ë¥¼ ì ‘ìˆ˜í–ˆìŠµë‹ˆë‹¤.
            
            - ë‹´ë‹¹ìžê°€ ê³§ ë°°ì •ë  ì˜ˆì •ìž…ë‹ˆë‹¤
            - ìž¬í˜„ ê°€ëŠ¥í•œ ìµœì†Œí•œì˜ ì˜ˆì œë¥¼ ì œê³µí•´ì£¼ì‹œë©´ ë¹ ë¥¸ í•´ê²°ì— ë„ì›€ì´ ë©ë‹ˆë‹¤
            - í™˜ê²½ ì •ë³´ì™€ ìŠ¤í¬ë¦°ìƒ·ì´ ìžˆë‹¤ë©´ ë”ìš± ì¢‹ìŠµë‹ˆë‹¤
            `;
          } else if (issueType.includes('[FEATURE]')) {
            welcomeMessage += `
            âœ¨ **ê¸°ëŠ¥ ìš”ì²­**ì„ ì ‘ìˆ˜í–ˆìŠµë‹ˆë‹¤.
            
            - ì œí’ˆ íŒ€ì—ì„œ ê²€í†  í›„ ìš°ì„ ìˆœìœ„ë¥¼ ê²°ì •í•  ì˜ˆì •ìž…ë‹ˆë‹¤
            - ì‚¬ìš© ì‚¬ë¡€ì™€ êµ¬ì²´ì ì¸ ìš”êµ¬ì‚¬í•­ì„ ìžì„¸ížˆ ì„¤ëª…í•´ì£¼ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤
            - ë””ìžì¸ ê°€ì´ë“œë¼ì¸ì´ë‚˜ ì°¸ê³  ìžë£Œê°€ ìžˆë‹¤ë©´ ê³µìœ í•´ì£¼ì„¸ìš”
            `;
          } else {
            welcomeMessage += `
            ðŸ“ **ì¼ë°˜ ì´ìŠˆ**ë¥¼ ì ‘ìˆ˜í–ˆìŠµë‹ˆë‹¤.
            
            - ì´ìŠˆ íƒ€ìž…ì— ë§žëŠ” ë¼ë²¨ì´ ìžë™ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤
            - í•„ìš”ì— ë”°ë¼ ë‹´ë‹¹ìžê°€ ë°°ì •ë  ì˜ˆì •ìž…ë‹ˆë‹¤
            `;
          }
          
          welcomeMessage += `
          
          ## ðŸ·ï¸ ìžë™í™” ì•ˆë‚´
          - âœ… ì´ìŠˆ íƒ€ìž…ì— ë”°ë¼ ìžë™ìœ¼ë¡œ ë¼ë²¨ì´ ì„¤ì •ë©ë‹ˆë‹¤
          - âœ… ìš°ì„ ìˆœìœ„ê°€ ìžë™ìœ¼ë¡œ í‰ê°€ë©ë‹ˆë‹¤
          - âœ… ì ì ˆí•œ ë‹´ë‹¹ìžê°€ ë°°ì •ë©ë‹ˆë‹¤
          
          ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ë‹µë³€ë“œë¦´ ìˆ˜ ìžˆë„ë¡ ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤! ðŸ˜Š
          `;
          
          await github.rest.issues.createComment({
            owner,
            repo,
            issue_number: number,
            body: welcomeMessage
          });

  issue-auto-label:
    name: ì´ìŠˆ ìžë™ ë¼ë²¨ë§
    runs-on: ubuntu-latest
    if: github.event.action == 'opened' || github.event.action == 'edited'
    
    steps:
    - name: ì´ìŠˆ ì œëª© ë° ë‚´ìš© ê¸°ë°˜ ìžë™ ë¼ë²¨ë§
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo, number } = context.issue;
          const title = context.payload.issue.title;
          const body = context.payload.issue.body || '';
          
          let labels = [];
          
          // ì œëª© ê¸°ë°˜ ë¼ë²¨ë§
          if (title.includes('[BUG]')) {
            labels.push('bug');
          }
          if (title.includes('[FEATURE]')) {
            labels.push('enhancement');
          }
          if (title.includes('[QUESTION]')) {
            labels.push('question');
          }
          if (title.includes('[DOCS]')) {
            labels.push('documentation');
          }
          
          // ë‚´ìš© ê¸°ë°˜ ë¼ë²¨ë§
          const content = (title + ' ' + body).toLowerCase();
          
          if (content.includes('backend') || content.includes('api')) {
            labels.push('backend');
          }
          if (content.includes('frontend') || content.includes('ui')) {
            labels.push('frontend');
          }
          if (content.includes('agent') || content.includes('ai')) {
            labels.push('agent');
          }
          
          // ìš°ì„ ìˆœìœ„ ì„¤ì •
          if (content.includes('urgent') || content.includes('critical')) {
            labels.push('priority-high');
          } else if (content.includes('improvement')) {
            labels.push('priority-low');
          } else {
            labels.push('priority-medium');
          }
          
          // ì¤‘ë³µ ì œê±°
          labels = [...new Set(labels)];
          
          if (labels.length > 0) {
            await github.rest.issues.addLabels({
              owner,
              repo,
              issue_number: number,
              labels: labels
            });
          }

  issue-auto-assign:
    name: ì´ìŠˆ ìžë™ í• ë‹¹
    runs-on: ubuntu-latest
    if: github.event.action == 'labeled'
    
    steps:
    - name: ë¼ë²¨ ê¸°ë°˜ ìžë™ í• ë‹¹
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo, number } = context.issue;
          const { data: issue } = await github.rest.issues.get({
            owner,
            repo,
            issue_number: number
          });
          
          const labels = issue.labels.map(label => label.name);
          let assignees = [];
          
          // ë¼ë²¨ ê¸°ë°˜ í• ë‹¹ ê·œì¹™ (ì‹¤ì œ GitHub ì•„ì´ë””ë¡œ ë³€ê²½ í•„ìš”)
          if (labels.includes('backend')) {
            assignees.push('backend-maintainer');
          }
          if (labels.includes('frontend')) {
            assignees.push('frontend-maintainer');
          }
          if (labels.includes('agent')) {
            assignees.push('ai-specialist');
          }
          
          // ì¤‘ë³µ ì œê±°
          assignees = [...new Set(assignees)];
          
          if (assignees.length > 0) {
            try {
              await github.rest.issues.addAssignees({
                owner,
                repo,
                issue_number: number,
                assignees: assignees
              });
              
              await github.rest.issues.createComment({
                owner,
                repo,
                issue_number: number,
                body: `ðŸŽ¯ **ìžë™ í• ë‹¹ ì™„ë£Œ** \n\në‹´ë‹¹ìž: ${assignees.map(a => `@${a}`).join(', ')}`
              });
            } catch (error) {
              console.log(`í• ë‹¹ ì‹¤íŒ¨: ${error.message}`);
            }
          } 